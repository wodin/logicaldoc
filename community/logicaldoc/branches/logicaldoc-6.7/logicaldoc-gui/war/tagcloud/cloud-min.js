function Clouder(b){var k=this;var O,T,j,i;var J=0,u=0;var D=null;var t=null;var K;var c;var N=[1];var z=8;var I;var M;var r,E;var s,R,L;var p=0.9,Q=0.9;var e=50;var m=0.08722;var A=0.2;var f=0.025;var g=0.4;var x=[];function S(){d(b.tags);O=I.clientWidth;T=I.clientHeight;U(function(h){h.span=null});if(L){I.style.backgroundColor=L}V();D=setInterval(v,e);K=I.offsetTop;c=I.offsetLeft;I.onmousemove=a;I.onmouseleave=B;I.onclick=y}function a(h){if(!h){h=window.event}G(h.clientX,h.clientY);n(q(h.clientX-c,h.clientY-K))}function B(h){if(!h){h=window.event}J=A;n(null)}function d(h){for(var w in h){var W={};W.text=h[w].text;W.id=h[w].id;W.weight=h[w].weight;W.x=1;W.y=0;W.z=0;P(W,(Math.random()*2-1)*Math.PI);H(W,(Math.random()*2-1)*Math.PI);P(W,(Math.random()*2-1)*Math.PI);x.push(W)}}function C(){for(var X in x){var ae=0,ad=0,ac=0;var w=x[X];for(var W in x){if(X==W){continue}var ab=w.x-x[W].x;var aa=w.y-x[W].y;var Z=w.z-x[W].z;var h=Math.sqrt(ab*ab+aa*aa+Z*Z);ae+=0.05/(h*h)*ab/h;ad+=0.05/(h*h)*aa/h;ac+=0.05/(h*h)*Z/h}w.x+=ae;w.y+=ad;w.z+=ac;var Y=Math.sqrt(w.x*w.x+w.y*w.y+w.z*w.z);w.x/=Y;w.y/=Y;w.z/=Y}}function o(h){return h>0?1:(h<0?-1:0)}function G(h,w){h=(j=h-I.offsetLeft)*2/O-1;h=(Math.abs(h)<f?0:(h-f*o(h))/(1-f))/p;w=(i=w-I.offsetTop)*2/T-1;w=(Math.abs(w)<f?0:(w-f*o(w))/(1-f))/Q;u=Math.atan2(w,h);J=Math.sqrt(h*h+w*w)}function V(){var h=(typeof(document.body.filters)=="object");U(function(Z){if(Z.span==null){Z.span=document.createElement("span");Z.width=0;Z.height=0;Z.span.innerHTML=Z.text;Z.span.style.fontWeight="bold";Z.span.style.position="absolute";var aa=1;for(var X in s){aa=aa*256+Math.floor((s[X]-R[X])*Z.weight+R[X])}Z.span.style.color="#"+aa.toString(16).substr(1);I.appendChild(Z.span);Z.span.descriptor=Z}var W=r+Z.z*E;Z.factor=W/r;if(Z.width==0){Z.width=Z.span.clientWidth/Z.factor;Z.height=Z.span.clientHeight/Z.factor}Z.span.style.fontSize=Math.round(W);Z.screenX=O*(Z.x*p+1)/2;Z.span.style.left=Z.screenX-Z.width*Z.factor/2;Z.screenY=T*(Z.y*Q+1)/2;Z.span.style.top=Z.screenY-Z.height*Z.factor/2;Z.span.style.zIndex=Z.z>=0?10:5;var w=(Math.sin(Z.z*Math.PI/2)/2+0.5)*(1-g)+g;if(!h){Z.span.style.opacity=w}else{var Y=Z.span.filters["DXImageTransform.Microsoft.Alpha"];if(Y){Y.opacity=w*100}else{Z.span.style.filter+="progid:DXImageTransform.Microsoft.Alpha(opacity="+(w*100)+")"}}})}function q(Z,Y){var W=O+T;var w=null;for(var X in x){var h=x[X];var ac=Z-h.screenX;var ab=Y-h.screenY;var aa=Math.sqrt(ac*ac+ab*ab)/h.factor;if(aa<W){W=aa;w=h}}return w}function n(h){if(t==h){return}if(t!=null){t.span.style.border=""}t=h;if(t!=null){t.span.style.border="1px solid black"}}function v(){var w=new Date().getTime();var h=function(W){P(W,-u);H(W,J*m);P(W,u)};U(h);C();V();n(q(j,i));N.push(new Date().getTime()-w);if(N.length>z){N.splice(0,N.length-z)}}function P(W,w){var h=W.x;var X=W.y;W.x=h*Math.cos(w)-X*Math.sin(w);W.y=h*Math.sin(w)+X*Math.cos(w)}function H(X,W){var h=X.x;var w=X.z;X.x=h*Math.cos(W)-w*Math.sin(W);X.z=h*Math.sin(W)+w*Math.cos(W)}function y(h){if(t==null||t.id==null){return}M(t.id)}function U(w){for(var h in x){w(x[h])}}function l(w){var h=parseInt(w.substr(1),16);return[Math.floor(h/65536),Math.floor((h/256)%256),Math.floor(h%256)]}function F(h){if(!h.container){alert("Clouder could not be created without container!");throw"Clouder without container"}I=h.container;if(!h.tags){alert("Clouder could not be crated without tags!");throw"Clouder without tags"}M=h.callback?h.callback:function(w){alert(w)};r=h.fontSize?h.fontSize:14;E=typeof(h.fontShift)!="undefined"?h.fontShift:r/2;s=h.colorMax?l(h.colorMax):l("#000000");R=h.colorMin?l(h.colorMin):l("#C0C0C0");L=h.colorBgr?h.colorBgr:null;e=typeof(h.interval)!="undefined"?h.interval:e;m=typeof(h.stepAngle)!="undefined"?h.stepAngle:m;A=typeof(h.idleMotion)!="undefined"?h.idleMotion:A;g=typeof(h.opaque)!="undefined"?h.opaque:g;f=typeof(h.nonSense)!="undefined"?h.nonSense:f;if(typeof(h.scale)!="undefined"){p=Q=h.scale}p=typeof(h.xScale)!="undefined"?h.xScale:p;Q=typeof(h.yScale)!="undefined"?h.yScale:Q}k.getRenderingTime=function(){var w=0;for(var h in N){w+=N[h]}return w/N.length};k.kill=function(){clearInterval(D);U(function(h){h.span.parentNode.removeChild(h.span)})};F(b);S()};