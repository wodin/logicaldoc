<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE beans PUBLIC "-//SPRING//DTD BEAN 2.0//EN" "http://www.springframework.org/dtd/spring-beans-2.0.dtd">
<beans>

	<!--
		*************************** 
		* Apache Directory Server * 
		***************************
		Version: 1.3.0.v20081020
	-->
	<bean id="LDAPUserGroupContext"
		class="com.logicaldoc.authentication.ldap.LDAPUserGroupContext">
		<property name="userIdentiferAttribute" value="uid" />
		<property name="logonAttribute" value="uid" />
		<property name="userClass" value="person" />
		<property name="groupClass" value="groupOfNames" />
		<property name="groupIdentiferAttribute" value="cn" />
		<property name="userBase">
			<list>
				<value>ou=users, ou=system</value>
			</list>
		</property>

		<property name="groupBase">
			<list>
				<value>ou=groups, ou=system</value>
			</list>
		</property>
	</bean>

	<!-- 
		Simple Authentication
	-->
	<bean id="contextSource"
		class="com.logicaldoc.authentication.ldap.BasicLDAPContextSource"
		scope="prototype">
		<property name="url" value="ldap://localhost:10389" />
		<property name="realm" value="localhost" />
		<property name="currentDN" value="ou=users, ou=system" />
		<property name="userGroupContext" ref="LDAPUserGroupContext" />
		<property name="userAuthenticationPatern"
			value="{logonAttribute}={userName},{userBaseEntry}" />
		<property name="userName" value="swenzky" />
		<property name="password" value="Test1234" />
	</bean>


	<!-- 
		******************** 
		* Active Directory * 
		********************
		Version: Windows Server 2003 Professional SP2
	-->
	<!-- 
		<bean id="LDAPUserGroupContext" class="com.logicaldoc.authentication.ldap.LDAPUserGroupContext">
		<property name="userIdentiferAttribute" value="CN"/>
		<property name="logonAttribute" value="sAMAccountName"/>
		<property name="userClass" value="person"/>
		<property name="groupClass" value="group"/>
		<property name="groupIdentiferAttribute" value="sAMAccountName"/>
		<property name="userBase">
		
		<list>
		<value>cn=users, dc=logicalobjects</value>
		</list>
		
		</property>
		
		<property name="groupBase">
		<list>
		<value>cn=Builtin, dc=logicalobjects</value>
		</list>
		</property>
		</bean>
	-->
	<!-- 
		Simple Authentication
	-->

	<!-- 
		<bean id="contextSource"
		class="com.logicaldoc.authentication.ldap.BasicLDAPContextSource" scope="prototype">
		<property name="url" value="ldap://logicaldoc:389" />
		<property name="realm" value="localhost"/>
		<property name="userGroupContext" ref="ldapUserGroupContext"/>
		
		<property name="userAuthenticationPatern" value="{userName}@logicalobjects"/>
		<property name="userName" value="Administrator" />
		<property name="password" value="1" />
		</bean>
	-->
	<!-- 
		DIGEST-MD5 Authentication
	-->
	<!-- 
		<bean id="contextSource"
		class="com.logicaldoc.authentication.ldap.DigestMD5LdapContextSource" scope="prototype">
		<property name="url" value="ldap://logicaldoc:389/DC=logicalobjects" />
		<property name="base" value="" />
		<property name="realm" value="logicalobjects"/>
		<property name="userName" value="swenzky" />
		<property name="password" value="Test1234" />
		</bean>
	-->

	<!-- 
		
		LDAP Core Implementations! Please be warrent: Customizing only if you know what you are doing! 
		
	-->

	<bean id="LdapTemplate"
		class="org.springframework.ldap.LdapTemplate" scope="prototype">
		<constructor-arg ref="contextSource" />
	</bean>

	<bean id="LDAPSynchronisationContext"
		class="com.logicaldoc.authentication.ldap.LDAPSynchronisationContext">
		<!-- time entries in quartz syntax -->
		<property name="synchronisationTime" value="" />
		<property name="ldapUserGroupContext"
			ref="LDAPUserGroupContext" />
		<property name="userGroupMapping">
			<map>

			</map>
		</property>
	</bean>

	<bean id="basicUserMapper"
		class="com.logicaldoc.authentication.ldap.UserAttributeMapper">
		<property name="ldapUserGroupContext"
			ref="LDAPUserGroupContext" />
	</bean>

	<bean id="basicGroupMapper"
		class="com.logicaldoc.authentication.ldap.GroupAttributeMapper">
	</bean>

	<bean id="ldapUserGroupDao"
		class="com.logicaldoc.authentication.ldap.UserGroupMappingImpl">
		<property name="ldapUserGroupContext"
			ref="LDAPUserGroupContext" />
		<property name="ldapTemplate" ref="LdapTemplate" />
		<property name="userMapper" ref="basicUserMapper" />
		<property name="groupMapper" ref="basicGroupMapper" />
	</bean>

	<bean id="synchronisationJob"
		class="com.logicaldoc.authentication.ldap.ExpImpSynchronisationJob">
		<property name="synchronisationContext"
			ref="LDAPSynchronisationContext" />
		<property name="ldapTemplate" ref="LdapTemplate" />
		<property name="userDao" ref="UserDAO" />
		<property name="groupDao" ref="GroupDAO" />
	</bean>

	<bean id="LDAPAuthenticationComponent"
		class="com.logicaldoc.authentication.ldap.LDAPAuthenticationComponent">
		<lookup-method name="obtainNewLdapContextSource"
			bean="contextSource" />
		<property name="ldapUserGroupContext"
			ref="LDAPUserGroupContext" />
		<property name="userGroupDao" ref="ldapUserGroupDao" />
		<property name="synchronisationJob" ref="synchronisationJob" />
		<property name="userDao" ref="UserDAO" />
		<property name="notValidatedUsers">
			<list>
				<value>admin</value>
			</list>
		</property>
	</bean>
</beans>